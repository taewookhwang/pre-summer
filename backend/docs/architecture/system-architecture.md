# 시스템 아키텍처 개요

## 1. 아키텍처 소개

본 문서는 홈클리닝 서비스의 백엔드 시스템 아키텍처에 대한 개요를 제공합니다. 시스템은 마이크로서비스 아키텍처를 기반으로 설계되었으며, 각 서비스는 특정 비즈니스 도메인을 담당합니다.

## 2. 아키텍처 다이어그램

```
                                  ┌───────────────┐
                                  │   클라이언트   │
                                  └───────┬───────┘
                                          │
                                          │ HTTPS
                                          ▼
┌─────────────────────────────────────────────────────────────────────┐
│                            API 게이트웨이                            │
└───┬────────┬────────┬────────┬────────┬────────┬────────┬────────┬──┘
    │        │        │        │        │        │        │        │
    ▼        ▼        ▼        ▼        ▼        ▼        ▼        ▼
┌────────┐┌────────┐┌────────┐┌────────┐┌────────┐┌────────┐┌────────┐┌────────┐
│  인증  ││ 소비자 ││ 기술자 ││  관리자 ││  결제  ││  매칭  ││  채팅  ││  기타  │
│서비스  ││ 서비스 ││ 서비스 ││ 서비스 ││ 서비스 ││ 서비스 ││ 서비스 ││ 서비스 │
└────┬───┘└────┬───┘└────┬───┘└────┬───┘└────┬───┘└────┬───┘└────┬───┘└────┬───┘
     │         │         │         │         │         │         │         │
     └─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┘
                                    │
                            ┌───────┴───────┐
                            │  공유 모듈    │
                            └───────────────┘
                                    │
                                    ▼
                            ┌───────────────┐
                            │  데이터베이스  │
                            └───────────────┘
```

## 3. 핵심 컴포넌트

### 3.1 API 게이트웨이

- **역할**: 모든 클라이언트 요청의 단일 진입점
- **기능**:
  - 요청 라우팅
  - 인증 및 권한 검증
  - 요청/응답 변환
  - 속도 제한
  - 로깅 및 모니터링

### 3.2 마이크로서비스

#### 3.2.1 인증 서비스 (AuthService)
- 사용자 등록 및 로그인
- 토큰 관리
- 인증 정보 검증

#### 3.2.2 소비자 서비스 (ConsumerService)
- 서비스 카테고리 및 상품 관리
- 예약 생성 및 관리
- 소비자 프로필 관리

#### 3.2.3 기술자 서비스 (TechnicianService)
- 기술자 프로필 관리
- 작업 일정 관리
- 작업 완료 및 보고

#### 3.2.4 관리자 서비스 (AdminService)
- 사용자 관리
- 대시보드 및 통계
- 시스템 설정

#### 3.2.5 결제 서비스 (PaymentService)
- 결제 처리
- 환불 관리
- 결제 이력

#### 3.2.6 매칭 서비스 (MatchingService)
- 소비자와 기술자 매칭
- 매칭 알고리즘
- 매칭 상태 관리

#### 3.2.7 채팅 서비스 (ChatService)
- 실시간 메시징
- 채팅방 관리
- 메시지 이력

#### 3.2.8 기타 서비스
- 파일 서비스: 파일 업로드 및 관리
- 알림 서비스: 이메일 및 푸시 알림
- 리뷰 서비스: 서비스 리뷰 관리
- 취소 서비스: 예약 취소 처리

### 3.3 공유 모듈

- **로깅**: 표준화된 로그 형식 및 레벨
- **설정**: 환경별 설정 관리
- **데이터베이스**: DB 연결 및 모델 정의
- **유틸리티**: 공통 유틸리티 함수
- **오류 처리**: 표준화된 오류 클래스
- **유효성 검증**: 공통 유효성 검증 규칙

### 3.4 데이터베이스

- **주 데이터베이스**: PostgreSQL
- **캐시**: Redis
- **데이터 모델**: 서비스별 독립 테이블 구조
- **확장성**: 읽기 전용 복제 지원 (운영 환경)

## 4. 통신 패턴

### 4.1 동기 통신
- REST API (HTTP/JSON)
- 서비스 간 직접 호출

### 4.2 비동기 통신
- 실시간 통신: WebSocket (Socket.IO)
- 이벤트 기반 통신: 이벤트 발행/구독 모델

## 5. 배포 모델

### 5.1 개발 환경
- 로컬 개발: Docker Compose
- 통합 테스트: 컨테이너화된 서비스

### 5.2 운영 환경
- 컨테이너 오케스트레이션
- 수평적 확장 지원
- 자동 복구 메커니즘

## 6. 보안 아키텍처

### 6.1 인증 및 권한
- JWT 기반 인증
- 역할 기반 접근 제어 (RBAC)
- API 키 관리

### 6.2 데이터 보안
- 전송 중 암호화 (HTTPS)
- 저장 데이터 암호화
- 민감 정보 보호

### 6.3 보안 모니터링
- 로그 분석
- 비정상 접근 탐지
- 보안 감사

## 7. 성능 최적화

### 7.1 캐싱 전략
- 응답 캐싱
- 데이터 캐싱
- 세션 캐싱

### 7.2 확장성
- 수평적 확장
- 부하 분산
- 데이터베이스 샤딩

## 8. 모니터링 및 로깅

### 8.1 모니터링
- 서비스 상태 모니터링
- 성능 메트릭 수집
- 알림 시스템

### 8.2 로깅
- 중앙화된 로그 수집
- 구조화된 로그 형식
- 로그 레벨 관리

## 9. 장애 대응 및 복구

### 9.1 장애 감지
- 서비스 헬스 체크
- 오류율 모니터링
- 응답 시간 모니터링

### 9.2 복구 전략
- 자동 재시작
- 장애 격리
- 롤백 메커니즘

## 10. 개발 가이드라인

### 10.1 코드 표준
- 일관된 코딩 스타일
- 코드 리뷰 프로세스
- 자동화된 코드 품질 검사

### 10.2 API 설계
- RESTful 설계 원칙
- 일관된 응답 형식
- 버전 관리

### 10.3 테스트
- 단위 테스트
- 통합 테스트
- E2E 테스트

## 11. 진화 전략

### 11.1 서비스 추가
- 새로운 비즈니스 요구사항에 따른 서비스 확장
- 기존 서비스의 기능 분할

### 11.2 기술 업그레이드
- 새로운 기술 평가 및 적용
- 레거시 시스템 마이그레이션

## 12. 결론

본 아키텍처는 확장성, 유지보수성, 안정성을 고려하여 설계되었으며, 비즈니스 요구사항의 변화에 유연하게 대응할 수 있는 구조를 제공합니다.